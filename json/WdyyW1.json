{"ver": "0.1", "info": {"id": "WdyyW1", "date": "1604310077", "viewed": 121, "name": "ps_Vortex", "username": "bigt", "description": "vortex\n\u9f20\u6807\u79fb\u52a8\u6539\u53d8\u5706\u5fc3\u4f4d\u7f6e", "likes": 6, "published": 1, "flags": 32, "usePreview": 0, "tags": [], "requires": ["texture", "imagebuf"]}, "renderpass": [{"inputs": [{"id": "4dXGR8", "filepath": "/media/previz/buffer00.png", "previewfilepath": "/media/previz/buffer00.png", "type": "buffer", "channel": 0, "sampler": {"filter": "linear", "wrap": "repeat", "vflip": "true", "srgb": "false", "internal": "byte"}, "published": 1}], "outputs": [{"id": "4dfGRr", "channel": 0}], "code": "float fAngle = 90.0;// \u66f4\u6539\u65cb\u8f6c\u89d2\u5ea6\nfloat fRadius = 0.3;\nint iSquare = 1;\nfloat fThreshold = 10.0;// aa(\u5355\u4f4d:\u50cf\u7d20)\n\n// \u6f29\u6da1\u7684\u7279\u5f81\u662f\u79bb\u5706\u5fc3\u8ddd\u79bb\u8d8a\u8fdc, \u65cb\u8f6c\u89d2\u5ea6\u8d8a\u5927\nvec4 vortexFilter(vec2 pos)\n{\t\n    // \u53d8\u6362\u5750\u6807\u7cfb,\u51b3\u5b9a\u662f\u5426\u4f7f\u7528\u5bbd\u9ad8\u6bd4\n    vec2 res = mix(min(iResolution.xx, iResolution.yy), iResolution.xy, float(iSquare));\n    pos = pos/iResolution.xy*res;\n    \n    // \u5706\u5fc3\u5750\u6807\n    float mouseDown = step(0.1, iMouse.z);\n    vec2 O = mix(vec2(0.5,0.4)*res, iMouse.xy/iResolution.xy*res, mouseDown);\n    \n    float maxRadius = min(res.x, res.y) * fRadius;// x,y\u9009\u53d6\u6700\u5c0f\u503c\u4f5c\u4e3a\u534a\u5f84\n\n    vec2 P = pos;// \u521d\u59cb\u5316\u5750\u6807\u4e3a\u5c4f\u5e55\u5750\u6807\n\n    vec2 OtoP = P - O;// \u4ee5\u5706\u5fc3\u4e3a\u5750\u6807\u539f\u70b9\n    float R = length(OtoP);\n    \n    // ------------------ \u6f29\u6da1\u4e3b\u8981\u4ee3\u7801 -----------------------------------------------------\n\tfloat attenuationFactor = 1.0-(R/maxRadius);// \u8ba1\u7b97\u65cb\u8f6c\u89d2\u5ea6\u7684\u8870\u51cf\u56e0\u5b50(\u79bb\u5706\u5fc3\u8d8a\u8fd1,\u65cb\u8f6c\u89d2\u5ea6\u53d8\u5316\u8d8a\u5c0f)\n\tfloat beta = atan(OtoP.y, OtoP.x);// \u8ba1\u7b97xOy\u5939\u89d2\n    beta += radians(fAngle) * attenuationFactor;// \u8ba1\u7b97\u6f29\u6da1\u7684\u89d2\u5ea6\n    P = O + R*vec2(cos(beta), sin(beta));// \u8ba1\u7b97\u65cb\u8f6c\u540e\u7684\u76f4\u89d2\u5750\u6807\n    // -------------------------------------------------------------------------------------\n    \n    // aa\n    float t = smoothstep(-fThreshold, fThreshold, R-maxRadius);// aa\n    vec3 col1 = texture(iChannel0, pos/res).rgb;\n    vec3 col2 = vec3(0.3,0.2,0.4) + texture(iChannel0, P/res).rgb;\n\n    return vec4( mix(col2, col1, t), 1.0 );\n}\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    fragColor = vortexFilter(fragCoord);\n}", "name": "Image", "description": "", "type": "image"}, {"inputs": [], "outputs": [{"id": "4dXGR8", "channel": 0}], "code": "// https://www.shadertoy.com/view/3sVyWh\nfloat checkerboard(vec2 pos, vec2 size, float threshold)\n{\n    vec2 gc = floor(pos/size);\n    float flag = abs(mod(gc.x,2.0) - mod(gc.y,2.0));\n    \n    // aa\n    vec2 t1 = smoothstep(size,size-threshold,pos - floor(pos/size)*size);\n    vec2 t2 = smoothstep(0.0,threshold,pos - floor(pos/size)*size);\n    float aa = t1.x*t1.y*t2.x*t2.y;\n    \n    return flag*aa;\n}\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    vec2 size = vec2(30.0,30.0);// \u68cb\u76d8\u683c\u7684\u5927\u5c0f(\u5355\u4f4d:\u50cf\u7d20)\n    vec3 col1 = vec3(0.15);// \u4e24\u4e2a\u683c\u5b50\u7684\u989c\u8272\n    vec3 col2 = vec3(0.85);\n    float threshold = 2.0;// aa(\u5355\u4f4d:\u50cf\u7d20)\n    \n    vec2 coord = fragCoord;\n    \n    float flag = checkerboard(coord, size, threshold);\n    vec3 col = mix(col1, col2, flag);\n    fragColor = vec4(col, 1.0);\n}", "name": "Buffer A", "description": "", "type": "buffer"}]}