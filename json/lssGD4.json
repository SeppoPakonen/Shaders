{"ver":"0.1","info":{"id":"lssGD4","date":"1371044366","viewed":697,"name":"cubemap to fisheye","username":"psde","description":"Simple cubemap to fisheye shader, inspired by and adapted from fisheyequake (http://strlen.com/gfxengine/fisheyequake/)","likes":4,"published":1,"flags":0,"tags":[]},"renderpass":[{"inputs":[{"id":"XsfGzn","filepath":"/media/a/585f9546c092f53ded45332b343144396c0b2d70d9965f585ebc172080d8aa58.jpg","previewfilepath":"/media/ap/585f9546c092f53ded45332b343144396c0b2d70d9965f585ebc172080d8aa58.jpg","type":"cubemap","channel":0,"sampler":{"filter":"linear","wrap":"clamp","vflip":"false","srgb":"false","internal":"byte"},"published":1},{"id":"XdX3zn","filepath":"/media/a/488bd40303a2e2b9a71987e48c66ef41f5e937174bf316d3ed0e86410784b919.jpg","previewfilepath":"/media/ap/488bd40303a2e2b9a71987e48c66ef41f5e937174bf316d3ed0e86410784b919.jpg","type":"cubemap","channel":1,"sampler":{"filter":"linear","wrap":"clamp","vflip":"false","srgb":"false","internal":"byte"},"published":1},{"id":"XsX3zn","filepath":"/media/a/94284d43be78f00eb6b298e6d78656a1b34e2b91b34940d02f1ca8b22310e8a0.png","previewfilepath":"/media/ap/94284d43be78f00eb6b298e6d78656a1b34e2b91b34940d02f1ca8b22310e8a0.png","type":"cubemap","channel":2,"sampler":{"filter":"linear","wrap":"clamp","vflip":"false","srgb":"false","internal":"byte"},"published":1}],"outputs":[],"code":"// Adapted from http://strlen.com/gfxengine/fisheyequake/\nvec3 fisheye_lookup(float fov, vec2 position)\n{\n\tvec2 d = position - 0.5;\n\t\n\tfloat yaw = sqrt(d.x*d.x+d.y*d.y) * fov;\n\n\tfloat roll = -atan(d.y, d.x);\n\tfloat sx = sin(yaw) * cos(roll);\n\tfloat sy = sin(yaw) * sin(roll);\n\tfloat sz = cos(yaw);\t\n\n\treturn vec3(sx, sy, sz);\n}\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n\tfloat fov = abs(sin(iTime * 0.2)) * 720.0 * 3.14  / 180.0;\n\tvec3 fisheye_coords = fisheye_lookup(fov, fragCoord.xy/iResolution.xy);\n\t\t\n\tfloat modlength = 15.7;\n\tfloat modtime = mod(iTime, modlength * 3.0);\n\n\tvec3 color = vec3(0);\n\t\n\tif(modtime > modlength*0.0 && modtime <= modlength*1.0)\n\t\tcolor = texture(iChannel0, -fisheye_coords).rgb;\n\t\n\tif(modtime > modlength*1.0 && modtime <= modlength*2.0)\n\t\tcolor = texture(iChannel1, -fisheye_coords).rgb;\n\t\n\tif(modtime > modlength*2.0 && modtime <= modlength*3.0)\n\t\tcolor = texture(iChannel2, -fisheye_coords).rgb;\n\t\n\tfragColor = vec4(color, 1.0); \n}","name":"","description":"","type":"image"}]}