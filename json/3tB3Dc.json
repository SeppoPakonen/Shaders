{"ver": "0.1", "info": {"id": "3tB3Dc", "date": "1561302036", "viewed": 172, "name": "Fractional", "username": "bencoder", "description": "Music: https://soundcloud.com/fractional/tess", "likes": 5, "published": 1, "flags": 64, "tags": ["beginner"], "requires": ["musicstreambuf", "imagebuf"]}, "renderpass": [{"inputs": [{"id": "lll3R2", "filepath": "https://soundcloud.com/fractional/tess", "previewfilepath": "https://soundcloud.com/fractional/tess", "type": "musicstream", "channel": 0, "sampler": {"filter": "linear", "wrap": "clamp", "vflip": "true", "srgb": "false", "internal": "byte"}, "published": 0}], "outputs": [{"id": "4dfGRr", "channel": 0}], "code": "#define time iChannelTime[0]\n\nmat2 rot(float a) {\n  float s = sin(a), c = cos(a);\n  return mat2(c,-s,s,c);\n}\n\nfloat cube(vec3 p)\n{\n  vec3 a = abs(p) - (time < 48.5 ? 1. : 0.3);\n  return max(a.x, max(a.y, a.z));\n}\n\nfloat map(vec3 p)\n{\n  for (int i=0;i<5;i++) {\n    p.xy *= rot(time * 0.43);\n    if (mod(time, 2.) < 1.)\n      p.yz *= rot(time * 0.32);\n    p.xz *= rot(time * 0.24);\n    p = abs(p);\n    p -= 5.-float(i)+sin(time);\n  }\n  return cube(p);\n}\n\nvec3 rm(vec3 ro, vec3 rd) {\n  vec3 p = ro;\n  for(int i=0;i<100;i++) {\n    float d = map(p);\n    if (abs(d) < 0.01) {\n      return vec3(1.-float(i)/100.);\n    }\n    p += rd*d;\n  }\n  return vec3(0.);\n  \n}\n\nvec3 pallete[] = vec3[](\n    vec3(1.), \n    vec3(1.,.5,.5), \n    vec3(.5,1.,.5), \n    vec3(.5,.5,1.),\n    vec3(1.,1.,.5), \n    vec3(.5,1.,1.), \n    vec3(1.,.5,1.)\n);\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n  vec2 uv = vec2(fragCoord.x / iResolution.x, fragCoord.y / iResolution.y);\n  uv -= 0.5;\n  uv /= vec2(iResolution.y / iResolution.x, 1);\n\n  vec3 ro = vec3(0.,0.,-60.);\n  vec3 rd = normalize(vec3(uv,1.));\n    if (time > 48.5) {\n                ro.z = -50.;\n        ro.xz *= rot(iTime*2.);\n        rd.xz *= rot(iTime*2.);\n        ro.y += cos(iTime)*5.;\n        ro.x += sin(iTime)*5.;\n\n    }\n\n  vec3 col = rm(ro, rd);\n    \n  int p = int(mod(time, float(pallete.length())));\n  \n  fragColor = vec4(pallete[p]*col,1.);\n}", "name": "Image", "description": "", "type": "image"}]}