{"ver": "0.1", "info": {"id": "7ltGRr", "date": "1635633564", "viewed": 39, "name": "blackhole idea", "username": "lechuga", "description": "after alkama's tutorial of 29/10/2021, and it was the initial idea for inercia demoparty, well, the one that i did wasn't like this one, probably because the pressure, but it's the same principle in both, it's a fractal with scale, i will keep practicing.", "likes": 2, "published": 1, "flags": 0, "usePreview": 0, "tags": [], "requires": ["imagebuf"]}, "renderpass": [{"inputs": [], "outputs": [{"id": "4dfGRr", "channel": 0}], "code": "// alkama's tutorial from i got some ideas:\n// https://www.twitch.tv/alkama/clip/FlaccidSincereJaguarHoneyBadger-lbF9wvM2g5W-pKju\n//\n// my shader from the shader royale inercia demoparty 2021:\n// https://www.shadertoy.com/view/sltGRr\n//\n#define rot(a) mat2(cos(a), sin(a), -sin(a), cos(a))\n#define pi acos( -1.)\nfloat t;\nfloat rep(float p, float s){\n    return (fract(p/s-.5)-.5)*s;\n}\n\nvec2 rep(vec2 p, vec2 s){\n    return (fract(p/s-.5)-.5)*s;\n}\nfloat smin(float a, float b, float k){\n    float h = max(0., k-abs(a-b))/k;\n    return min(a,b) - h * h * k *.25;\n}\n\nfloat sbb(vec3 p, vec3 s){\n  p = abs(p)-s;\n  return mix(max(max(p.x,p.y), p.z), length(p.xz), .25);\n}\nfloat sbt(vec3 p, vec2 s){\n    return length(vec2(length(p.xy)-s.x, p.z))-s.y;\n}\nfloat cc(float t){\n    return mix(floor(t), floor(t+1.), pow(smoothstep(0., 1., fract(t)), 10.));\n}\nfloat fractal(vec3 p){\n  p.xz*=rot(t+p.y*.1565);\n  p.yz*=rot(cc(t)*.5+p.y*.25+t);\n  \n  float k,sc = 1.; //test\n  for(float i = 0.; i < 8.; i++){\n      p.yz *= rot(p.x*.154+i*i+t);\n      p=abs(p)-.65;\n      k = max(1., .98/dot(p,p));\n      p*=k;\n      sc*=k;\n  }\n  float cucube = sbb(p,vec3(.55))/sc;\n  \n  return cucube*.56;\n}\nfloat lcg=1.;\nfloat internalBlackHole(vec3 p){\n  float d = fractal(p);\n  float lc = length(p)-1.;\n  lcg -= 1./(1.+lc*lc*lc)+.0015;\n  d = smin(d,lc, 1.);\n  return d; \n}\nfloat lcg2, lcd;\nfloat spiral(vec3 p){\n  vec3 p1 = p;\n  float d = internalBlackHole(p);\n  p.yx *= rot(p.z*.94+cc(t)+t*4.);\n  p.xy = abs(p.xy);\n  float a = length(p.xy-vec2(2.))+sin(t)*.5-.5;\n  lcd = a;\n  lcg2+=.1/(.1+a);\n  d=smin(d, a*.45, .1);\n  //p.zy=ratan(p.xy,vec2(1.,3.));\n  p1.z = rep(p1.z, 10.);\n  d=min(d,sbt(p1,vec2(3.,1.)));\n  return d;\n}\n\nfloat lightCenter;\nfloat m(vec3 p){\n  float d = spiral(p);\n  p.z += 5.;\n  float light = length(p)-1.-sin(t)*.5-.5;\n  lightCenter += .01/(.01+light*light);\n  d=min(d, lightCenter);\n  return d;\n}\n\nvec3 nm(vec3 p){\n    const vec2 e = vec2(-0.0341,0.01545);\n  return normalize(m(p)-vec3(m(p-e.xyy), m(p-e.yxy) , m(p-e.yyx)));\n}\n#define aa(d) clamp(m(p+=d*r)/d, 0., 1.)\n#define ss(d) smoothstep(0.,1., m(p+=d*r)/d)\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    t= mod(iTime, 300./(2.*pi))*0.035;\n    vec2 uv = fragCoord/iResolution.xy;\n\tuv -= 0.5;\n\tuv /= vec2(iResolution.y / iResolution.x, 1);\n  const float dis = 3.5;\n  vec3 s = vec3(0.01, 0.151, -3.-sin(t*.55)*dis-dis);\n  vec3 p = s;\n  vec3 tg = vec3(0.5);\n  tg.x+=sin(t*2.)*4.;\n  tg.zy += sin(t*2.)*4.;\n  vec3 cz = normalize(vec3(tg-s));\n  vec3 cx = normalize(cross(cz, vec3(0., -1., 0.)));\n  vec3 cy = normalize(cross(cz,cx));\n  vec3 r = mat3(cx,cy,cz) * normalize(vec3(-uv, 1.-length(uv)*.27541));\n  vec2  dh = vec2(0.);\n  vec3 co = vec3(0.);\n  vec3 n;\n  for(int i  = 0; i < 200; i++){\n    if(dh.y = m(p), abs(dh.y) < .0001){\n      n = nm(p);\n      vec3 l = normalize(vec3(-1.)-p);\n      float dif = max(0., dot(l, n));\n      float fr = pow(max(0., 1.+dif),3.);\n      float sp = pow(max(0., dot(reflect(-l, n), r)),40.);\n      co = vec3(dif*aa(0.2)+sp*ss(0.345))*fr;\n      if(abs(lcd) < 1.5) r=reflect(r, n), p++;\n      else break;\n    }\n    if(abs(dh.x) >  100.) break;\n    dh.x += dh.y;\n    p+=dh.y*r;\n    float sc = .009;\n    co += lcg*sc*vec3(0.942+n.x*.34+sin(t), 0.234+n.y*.45+cos(t), 0.234+n.z*.45+cos(t))*.0985;\n    co += lcg2*sc*vec3(0.13,0., 0.95)*.0255;\n    co += lightCenter * vec3(0.023)*.0186;\n  }\n\tfragColor = vec4(co , 1.);\n}", "name": "Image", "description": "", "type": "image"}]}