{"ver": "0.1", "info": {"id": "Msf3R4", "date": "1363542707", "viewed": 635, "name": "spectrum_mod", "username": "teh_bear", "description": "modifed LED spectrum", "likes": 20, "published": 1, "flags": 0, "tags": ["spectrum"], "requires": ["musicbuf", "imagebuf", "texture"]}, "renderpass": [{"inputs": [{"id": "4df3Rn", "filepath": "/media/a/3c33c415862bb7964d256f4749408247da6596f2167dca2c86cc38f83c244aa6.mp3", "previewfilepath": "/media/ap/3c33c415862bb7964d256f4749408247da6596f2167dca2c86cc38f83c244aa6.mp3", "type": "music", "channel": 0, "sampler": {"filter": "linear", "wrap": "clamp", "vflip": "false", "srgb": "false", "internal": "byte"}, "published": 1}], "outputs": [], "code": "const float PI = 3.14159;\r\n\r\nvec3 hsv(float h,float s,float v) {\r\n\treturn mix(vec3(1.),clamp((abs(fract(h+vec3(3.,2.,1.)/3.)*6.-3.)-1.),0.,1.),s)*v;\r\n}\r\n\r\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\r\n{\r\n    // create pixel coordinates\r\n\tvec2 uv = fragCoord.xy / iResolution.xy;\r\n\t\r\n\t// quantize coordinates\r\n\tconst float bands = 40.0;\r\n\tvec2 p;\r\n\tp.x = floor(uv.x*bands)/bands;\r\n\tp.y = uv.y;\r\n\t\r\n\t// read frequency data from first row of texture\r\n\tfloat fft  = texture( iChannel0, vec2(p.x,0.0) ).x;\t\r\n\r\n\t// led color\r\n\tvec3 color = hsv(p.x, 1.0 - p.y, 1.0);\r\n\t\r\n\t// led shape\r\n\tfloat dx = fract( (uv.x - p.x) * bands) - 0.5;\r\n\t//float led = smoothstep(0.5, 0.3, abs(d.x)) *\r\n\t//\t        smoothstep(0.5, 0.3, abs(d.y));\r\n\t\r\n\tfloat led = smoothstep(0.5, 0.3, abs(dx));\t\r\n\t\r\n\t// output final color\r\n\t//fragColor = vec4(vec3(fft),1.0);\r\n\r\n    //fragColor = vec4(d, 0.0, 1.0);\t\r\n\t\r\n\t//fragColor = vec4(vec3(led), 1.0);\r\n\t\r\n\t// mask for bar graph\r\n\tfloat mask = (p.y < fft) ? 1.0 : 0.0;\t\r\n\tfragColor = vec4(color*mask*led, 1.0);\r\n}\r\n", "name": "", "description": "", "type": "image"}]}