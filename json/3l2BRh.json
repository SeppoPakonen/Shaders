{"ver":"0.1","info":{"id":"3l2BRh","date":"1598307387","viewed":43,"name":"Camera lens distortion","username":"mwtarnowski","description":"Modeling camera lens distortion with 6 radial distortion coeffs (k1 - k6) and 2 tangential distortion coeffs (p1, p2). Real lenses usually have mostly radial distortion (barrel/pincushion distortion) and slight tangential distortion.","likes":4,"published":1,"flags":0,"tags":[]},"renderpass":[{"inputs":[{"id":"Xdf3zn","filepath":"/media/a/85a6d68622b36995ccb98a89bbb119edf167c914660e4450d313de049320005c.png","previewfilepath":"/media/ap/85a6d68622b36995ccb98a89bbb119edf167c914660e4450d313de049320005c.png","type":"texture","channel":0,"sampler":{"filter":"nearest","wrap":"repeat","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dfGRr","channel":0}],"code":"vec2 lensDistortion(vec2 uv) {\n    // radial distortion coefficients\n    float k1 = 0.126;\n    float k2 = 0.004;\n    float k3 = 0.001;\n    float k4 = 0.;\n    float k5 = 0.;\n    float k6 = 0.;\n    // tangential distortion coefficients\n    float p1 = 0.001;\n    float p2 = 0.001;\n    \n    float x = uv.x;\n    float y = uv.y;\n    float r2 = x*x + y*y;\n    \n    float num = 1. + (k1 + (k2 + k3*r2)*r2)*r2;\n    float den = 1. + (k4 + (k5 + k6*r2)*r2)*r2;\n    float rd = num / den;\n    \n    vec2 td;\n    td.x = 2.*p1*x*y + p2*(r2 + 2.*x*x);\n    td.y = p1*(r2 + 2.*y*y) + 2.*p2*x*y;\n    \n    return uv*rd + td;\n}\n\n\nvoid mainImage(out vec4 fragColor, in vec2 fragCoord) {\n\tvec2 uv = fragCoord.xy / iResolution.xy;\n    uv = 2. * uv - 1.;\n    uv = lensDistortion(uv);\n    uv = .5 * (uv + 1.);\n    \n    float c = texture(iChannel0, uv).r;\n\tfragColor = vec4(vec3(c), 1.);\n}\n","name":"Image","description":"","type":"image"}]}