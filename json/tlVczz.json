{"ver": "0.1", "info": {"id": "tlVczz", "date": "1610405031", "viewed": 45, "name": "barycentric coordinate solver", "username": "Reynolds", "description": "harmonic coordinates", "likes": 0, "published": 1, "flags": 32, "usePreview": 0, "tags": [], "requires": ["texture", "imagebuf"]}, "renderpass": [{"inputs": [{"id": "XsXGR8", "filepath": "/media/previz/buffer01.png", "previewfilepath": "/media/previz/buffer01.png", "type": "buffer", "channel": 0, "sampler": {"filter": "linear", "wrap": "clamp", "vflip": "true", "srgb": "false", "internal": "byte"}, "published": 1}], "outputs": [{"id": "4dfGRr", "channel": 0}], "code": "float sdTriangle( in vec2 p, in vec2 p0, in vec2 p1, in vec2 p2 )\n{\n    vec2 e0 = p1-p0, e1 = p2-p1, e2 = p0-p2;\n    vec2 v0 = p -p0, v1 = p -p1, v2 = p -p2;\n    vec2 pq0 = v0 - e0*clamp( dot(v0,e0)/dot(e0,e0), 0.0, 1.0 );\n    vec2 pq1 = v1 - e1*clamp( dot(v1,e1)/dot(e1,e1), 0.0, 1.0 );\n    vec2 pq2 = v2 - e2*clamp( dot(v2,e2)/dot(e2,e2), 0.0, 1.0 );\n    float s = sign( e0.x*e2.y - e0.y*e2.x );\n    vec2 d = min(min(vec2(dot(pq0,pq0), s*(v0.x*e0.y-v0.y*e0.x)),\n                     vec2(dot(pq1,pq1), s*(v1.x*e1.y-v1.y*e1.x))),\n                     vec2(dot(pq2,pq2), s*(v2.x*e2.y-v2.y*e2.x)));\n    return -sqrt(d.x)*sign(d.y);\n}\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    // Normalized pixel coordinates (from 0 to 1)\n    vec2 uv = fragCoord/iResolution.xy;\n\n    vec4 col = texture(iChannel0, uv);\n\n    if(sdTriangle(uv, vec2(0.25, 0.25), vec2(0.75, 0.25), vec2(0.5, 0.75)) < 0.0) {\n        fragColor = vec4(sin(col.z*250.0)*col);\n    } else {\n        fragColor = vec4(1.0);\n    }\n}", "name": "Image", "description": "", "type": "image"}, {"inputs": [{"id": "4dXGR8", "filepath": "/media/previz/buffer00.png", "previewfilepath": "/media/previz/buffer00.png", "type": "buffer", "channel": 0, "sampler": {"filter": "linear", "wrap": "clamp", "vflip": "true", "srgb": "false", "internal": "byte"}, "published": 1}, {"id": "XsXGR8", "filepath": "/media/previz/buffer01.png", "previewfilepath": "/media/previz/buffer01.png", "type": "buffer", "channel": 1, "sampler": {"filter": "linear", "wrap": "clamp", "vflip": "true", "srgb": "false", "internal": "byte"}, "published": 1}], "outputs": [{"id": "XsXGR8", "channel": 0}], "code": "void mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    vec2 uv = fragCoord/iResolution.xy;\n    \n    vec4 colA = texture(iChannel0, uv);\n    \n    \n    int s = max(1, 100 - iFrame);\n    //vec4 col1 = texture(iChannel1, uv);\n    vec4 col2 = texelFetch(iChannel1, ivec2(fragCoord.xy) + ivec2(s, 0), 0);\n    vec4 col3 = texelFetch(iChannel1, ivec2(fragCoord.xy) + ivec2(-s, 0), 0);\n    vec4 col4 = texelFetch(iChannel1, ivec2(fragCoord.xy) + ivec2(0, s), 0);\n    vec4 col5 = texelFetch(iChannel1, ivec2(fragCoord.xy) + ivec2(0, -s), 0);\n    \n    fragColor = mix(colA, 0.25*(col2 + col3 + col4 + col5), colA.w);\n    \n    //fragColor.w = max(1.0, fragColor.w - 0.005);\n}", "name": "Buffer B", "description": "", "type": "buffer"}, {"inputs": [], "outputs": [{"id": "4dXGR8", "channel": 0}], "code": " vec3[5] Ds = vec3[5](vec3(153.0, 138.0, 211.0)/255.0,\n vec3(228.0, 148.0, 211.0)/255.0,\n vec3(205.0, 241.0, 175.0)/255.0,\n vec3(135.0, 220.0, 195.0)/255.0,\n vec3(136.0, 187.0, 228.0)/255.0);\n\n\nvec4 sdSegment(vec2 p, vec2 a, vec2 b, int i)\n{\n    vec2 pa = p-a, ba = b-a;\n    float A = dot(pa,ba)/dot(ba,ba);\n    float h = clamp( A, 0.0, 1.0 );\n    vec2 n = vec2(-ba.y, ba.x);\n    vec3 coords;\n    float tt = fract(iTime/2.0);\n    int q = int(floor(iTime/2.0));\n    int r = q + 1;\n    \n    float B = clamp(dot(pa, normalize(ba)) / length(ba), 0.0,1.0);\n    coords = vec3(0.0);\n    coords[i] = 1.0 -B;\n    coords[(i+1)%3] = B;\n    \n    float s = 1.0;\n    if(dot(n, pa) < 0.0) {\n        s *= -1.0;\n    }\n    return vec4(s*length( pa - ba*h), coords);\n}\n\nvec4 minA(vec4 d, vec4 e) {\n    float a = float(d.x < e.x);\n    return vec4(min(d.x, e.x), mix(d.yzw, e.yzw, 1.0-a));\n}\n\nvec4 sdScene(vec2 p) {\n\n    vec2 A = vec2(0.25, 0.25);\n    vec2 B = vec2(0.75, 0.25);\n    vec2 C = vec2(0.5, 0.75);\n\n    vec4 d = sdSegment(p, A, B, 0);\n    d = minA(d, sdSegment(p, B, C, 1));\n    d = minA(d, sdSegment(p, C, A, 2));\n    \n    return d;\n}\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    fragColor = vec4(0.0,0.0,0.0,1.0);\n    vec2 uv = fragCoord/iResolution.xy;\n    \n    vec4 d = sdScene(uv);\n    if(d.x < 0.0025) {\n        fragColor = vec4(d.yzw, 0.0);\n    }\n}", "name": "Buffer A", "description": "", "type": "buffer"}]}