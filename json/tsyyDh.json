{"ver": "0.1", "info": {"id": "tsyyDh", "date": "1602696049", "viewed": 175, "name": "Solid/Fluid interaction", "username": "wyatt", "description": "Still studying - I'm still missing something...", "likes": 10, "published": 3, "flags": 32, "tags": ["mechanic"], "requires": ["texture", "imagebuf", "library", "texturebuf"]}, "renderpass": [{"inputs": [{"id": "4dXGRn", "filepath": "/media/a/10eb4fe0ac8a7dc348a2cc282ca5df1759ab8bf680117e4047728100969e7b43.jpg", "previewfilepath": "/media/ap/10eb4fe0ac8a7dc348a2cc282ca5df1759ab8bf680117e4047728100969e7b43.jpg", "type": "texture", "channel": 3, "sampler": {"filter": "mipmap", "wrap": "repeat", "vflip": "true", "srgb": "false", "internal": "byte"}, "published": 1}, {"id": "4dXGR8", "filepath": "/media/previz/buffer00.png", "previewfilepath": "/media/previz/buffer00.png", "type": "buffer", "channel": 0, "sampler": {"filter": "linear", "wrap": "clamp", "vflip": "true", "srgb": "false", "internal": "byte"}, "published": 1}, {"id": "XsXGR8", "filepath": "/media/previz/buffer01.png", "previewfilepath": "/media/previz/buffer01.png", "type": "buffer", "channel": 1, "sampler": {"filter": "linear", "wrap": "clamp", "vflip": "true", "srgb": "false", "internal": "byte"}, "published": 1}, {"id": "4sXGR8", "filepath": "/media/previz/buffer02.png", "previewfilepath": "/media/previz/buffer02.png", "type": "buffer", "channel": 2, "sampler": {"filter": "linear", "wrap": "clamp", "vflip": "true", "srgb": "false", "internal": "byte"}, "published": 1}], "outputs": [{"id": "4dfGRr", "channel": 0}], "code": "Main {\n\tvec4 c = C(U);\n    vec4 a = A(U);\n    \n    Q = 0.5+0.5*sin(-.2*(a.x*a.z-a.y*a.w)*vec4(1,2,3,4));\n    float sm = smoothstep(2.,1.,length(c.xy-0.5*R)-.25*R.y);\n    \n    Q = mix(Q,1.-D(c.xy),sm);\n    float \n        n = length(A(U+vec2(0,1))),\n        e = length(A(U+vec2(1,0))),\n        s = length(A(U-vec2(0,1))),\n        w = length(A(U-vec2(1,0)));\n    vec3 norm = \n        normalize(vec3(e-w,n-s,.1)),\n        ref = reflect(vec3(0,0,-1),norm);\n   \tvec3 l = R.xyy;\n    float li = ln(vec3(U,0),vec3(U,0)+ref,l);\n    Q *= .5+0.5*exp(-li)+.5*exp(-3.*li);\n\n}", "name": "Image", "description": "", "type": "image"}, {"inputs": [{"id": "4dXGR8", "filepath": "/media/previz/buffer00.png", "previewfilepath": "/media/previz/buffer00.png", "type": "buffer", "channel": 0, "sampler": {"filter": "linear", "wrap": "repeat", "vflip": "true", "srgb": "false", "internal": "byte"}, "published": 1}, {"id": "XsXGR8", "filepath": "/media/previz/buffer01.png", "previewfilepath": "/media/previz/buffer01.png", "type": "buffer", "channel": 1, "sampler": {"filter": "linear", "wrap": "repeat", "vflip": "true", "srgb": "false", "internal": "byte"}, "published": 1}, {"id": "XdfGR8", "filepath": "/media/previz/buffer03.png", "previewfilepath": "/media/previz/buffer03.png", "type": "buffer", "channel": 3, "sampler": {"filter": "linear", "wrap": "repeat", "vflip": "true", "srgb": "false", "internal": "byte"}, "published": 1}], "outputs": [{"id": "4dXGR8", "channel": 0}], "code": "vec4 Aa (vec2 U) {\n\treturn A(U-D(U).xy);\n}\nvec4 Bb (vec2 U) {\n\treturn B(U-D(U).xy);\n}\nvec4 Cc (vec2 U) {\n\treturn C(U-D(U).xy);\n}\nMain {\n\tQ = Aa(U);\n    vec4 c = Cc(U),\n         b = Bb(U);\n    mat2 m = mat2(Q);\n    float sm = smoothstep(2.,1.,length(c.xy-0.5*R)-.25*R.y);\n    vec4 f = vec4(0);\n    for (int x = -1; x<=1; x++)\n    for (int y = -1; y<=1; y++)\n    if (abs(x)!=abs(y))\n    {\n        vec2 u = vec2(x,y);\n    \tvec4 bb = Bb(U+u);\n    \tvec4 cc = Cc(U+u);\n        vec2 dv = bb.xy-b.xy;\n        u /= length(u);\n        f += 0.25*vec4(dv.x*u.x,dv.y*u.x,dv.x*u.y,dv.y*u.y);\n    }\n    m -= 0.25*mat2(f)*m;\n    Q = vec4(m);\n\tif (iFrame < 1) Q = vec4(1,0,0,1);\n    \n}", "name": "Buffer A", "description": "", "type": "buffer"}, {"inputs": [{"id": "4dXGR8", "filepath": "/media/previz/buffer00.png", "previewfilepath": "/media/previz/buffer00.png", "type": "buffer", "channel": 1, "sampler": {"filter": "linear", "wrap": "repeat", "vflip": "true", "srgb": "false", "internal": "byte"}, "published": 1}, {"id": "XsXGR8", "filepath": "/media/previz/buffer01.png", "previewfilepath": "/media/previz/buffer01.png", "type": "buffer", "channel": 0, "sampler": {"filter": "linear", "wrap": "repeat", "vflip": "true", "srgb": "false", "internal": "byte"}, "published": 1}, {"id": "4sXGR8", "filepath": "/media/previz/buffer02.png", "previewfilepath": "/media/previz/buffer02.png", "type": "buffer", "channel": 2, "sampler": {"filter": "linear", "wrap": "repeat", "vflip": "true", "srgb": "false", "internal": "byte"}, "published": 1}, {"id": "XdfGR8", "filepath": "/media/previz/buffer03.png", "previewfilepath": "/media/previz/buffer03.png", "type": "buffer", "channel": 3, "sampler": {"filter": "linear", "wrap": "repeat", "vflip": "true", "srgb": "false", "internal": "byte"}, "published": 1}], "outputs": [{"id": "XsXGR8", "channel": 0}], "code": "vec4 Aa (vec2 U) {\n\treturn A(U-D(U).xy);\n}\nvec4 Bb (vec2 U) {\n\treturn B(U-D(U).xy);\n}\nvec4 Cc (vec2 U) {\n\treturn C(U-D(U).xy);\n}\nvec4 Dd (vec2 U) {\n\treturn D(U-D(U).xy);\n}\nMain {\n\tQ = Aa(U);\n    vec4\n        c = Cc(U),\n        b = Bb(U),\n        d = Dd(U);\n    float p = b.x*b.w-b.y*b.z;\n    float t = b.x*b.z-b.y*b.w;\n    float sm = smoothstep(1.,-1.,length(c.xy-0.5*R)-.25*R.y);\n    Q = mix(Q,d,.001+.5*sm);\n    for (int x = -1; x <= 1; x++)\n    for (int y = -1; y <= 1; y++)\n    if (abs(x)!=abs(y))\n    {\n        vec2 u = vec2(x,y);\n    \tvec4 cc = Cc(U+u);\n        vec4 bb = Bb(U+u);\n        float l = length(u);\n        u /= l;\n        float pp = bb.x*bb.w-bb.y*bb.z;\n        float tt = bb.x*bb.z-bb.y*bb.w;\n        float smm = smoothstep(1.,-2.,length(cc.xy-0.5*R)-.25*R.y);\n        Q.xy -= sm*(mat2(bb)*mat2(bb)*u);\n        Q.xy -= (1.-sm)*pp*u;\n   \t\n   \t}\n\t\n    Q.y -= sm*1e-3/(1.+10.*length(Q.xy));\n    if (iMouse.z>0.&&length(U-iMouse.xy)<10.)\n        Q.xy = vec2(0,0.5);\n    if (iFrame < 2) {\n    \tQ = vec4(0);\n        Q.y = .1*sm;\n    }\n    if (length(Q.xy)>.8) Q.xy *= .9;\n    //if(U.x<5.||U.y<5.||R.x-U.x<5.||R.y-U.y<5.) Q *= 0.;\n}", "name": "Buffer B", "description": "", "type": "buffer"}, {"inputs": [], "outputs": [], "code": "#define R iResolution.xy\n#define A(U) texture(iChannel0,(U)/R)\n#define B(U) texture(iChannel1,(U)/R)\n#define C(U) texture(iChannel2,(U)/R)\n#define D(U) texture(iChannel3,(U)/R)\n\n#define Main void mainImage (out vec4 Q, in vec2 U)\n\nfloat ln (vec2 p, vec2 a, vec2 b) { // returns distance to line segment for mouse input\n    return length(p-a-(b-a)*clamp(dot(p-a,b-a)/dot(b-a,b-a),0.,1.));\n}float ln (vec3 p, vec3 a, vec3 b) { // returns distance to line segment for mouse input\n    return length(p-a-(b-a)*dot(p-a,b-a)/dot(b-a,b-a));\n}", "name": "Common", "description": "", "type": "common"}, {"inputs": [{"id": "4dXGR8", "filepath": "/media/previz/buffer00.png", "previewfilepath": "/media/previz/buffer00.png", "type": "buffer", "channel": 0, "sampler": {"filter": "linear", "wrap": "repeat", "vflip": "true", "srgb": "false", "internal": "byte"}, "published": 1}, {"id": "XsXGR8", "filepath": "/media/previz/buffer01.png", "previewfilepath": "/media/previz/buffer01.png", "type": "buffer", "channel": 1, "sampler": {"filter": "linear", "wrap": "repeat", "vflip": "true", "srgb": "false", "internal": "byte"}, "published": 1}, {"id": "4sXGR8", "filepath": "/media/previz/buffer02.png", "previewfilepath": "/media/previz/buffer02.png", "type": "buffer", "channel": 2, "sampler": {"filter": "linear", "wrap": "repeat", "vflip": "true", "srgb": "false", "internal": "byte"}, "published": 1}, {"id": "XdfGR8", "filepath": "/media/previz/buffer03.png", "previewfilepath": "/media/previz/buffer03.png", "type": "buffer", "channel": 3, "sampler": {"filter": "linear", "wrap": "repeat", "vflip": "true", "srgb": "false", "internal": "byte"}, "published": 1}], "outputs": [{"id": "4sXGR8", "channel": 0}], "code": "Main {\n    \n    \n\tif (iFrame < 1) Q = vec4(U,0,0);\n    else {\n        U -= .5*D(U).xy;\n        U -= .5*D(U).xy;\n        Q = C(U),R.xyxy;\n    }\n    //if (iMouse.z>0.&&length(U-iMouse.xy)<20.)\n    //    Q.xy = iMouse.xy-U+0.5*R;\n}", "name": "Buffer C", "description": "", "type": "buffer"}, {"inputs": [{"id": "XsXGR8", "filepath": "/media/previz/buffer01.png", "previewfilepath": "/media/previz/buffer01.png", "type": "buffer", "channel": 1, "sampler": {"filter": "linear", "wrap": "repeat", "vflip": "true", "srgb": "false", "internal": "byte"}, "published": 1}], "outputs": [{"id": "XdfGR8", "channel": 0}], "code": "Main {\n    Q = vec4(0);\n\tfor (int x = -1; x<=1; x++)\n\tfor (int y = -1; y<=1; y++)\n    if (x!=0||y!=0)\n    {\n    \tQ += 0.125*B(U+vec2(x,y));\n    }\n}", "name": "Buffer D", "description": "", "type": "buffer"}]}