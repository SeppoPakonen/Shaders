{"ver":"0.1","info":{"id":"4tscR4","date":"1503723643","viewed":401,"name":"Proceudual Landscape(jp comment)","username":"sw","description":"based on:\nhttps://www.shadertoy.com/view/4tlSDS\n\nadd japanese comment.\n\n\u307b\u307c\u3059\u3079\u3066\u306e\u884c\u306b\u65e5\u672c\u8a9e\u306e\u30b3\u30e1\u30f3\u30c8\u3092\u8db3\u3057\u307e\u3057\u305f\u3002\n\u7406\u89e3\u304c\u6df1\u3081\u3084\u3059\u3044\u304b\u3082?","likes":0,"published":1,"flags":0,"tags":[]},"renderpass":[{"inputs":[],"outputs":[{"id":"4dfGRr","channel":0}],"code":"float cosNoise(in vec2 pos){\n    return 0.5*(sin(pos.x) + sin(pos.y));\n}\n\nconst mat2 m2 = mat2(0.8, -0.6,\n                     0.6, 0.8); \n\nfloat map(in vec3 pos){// pos:\u30ec\u30a4\u306e\u4f4d\u7f6e\n//  return length(pos - vec3(0.0,0.0,-2.0)) -1.0;\n    vec2 q = pos.xz * 0.5; // \u5c71\u3005\u306e\u611f\u899a\u3092\u5e83\u3052\u308b\n    float h = 0.0;\n\n    float s = 0.5;  // noise\u306e\u91cf\n    for(int i = 0; i<10; i++){\n        h += s*cosNoise(q);   // xz\u304b\u3089\u9ad8\u3055\u3092\u6c42\u3081\u308b\n        s *= 0.5;            // noise\u306e\u91cf\u3092\u6e1b\u3089\u3059 \u6e1b\u3089\u3059\u3053\u3068\u3067\u5c71\u306e\u5148\u7aef\u306e\u7d30\u3055\u3092\u4f5c\u3063\u3066\u308b\n        q = m2 * q * 1.7;    // \u56de\u8ee2\u3059\u308b\u3053\u3068\u3067\u30dc\u30b3\u30dc\u30b3\u3055\u305b\u308b\n    }\n    \n    h *= 3.0;   // \u5c71\u3092\u9ad8\u304f\u3059\u308b\n  \n    return pos.y - h;   // \u30ec\u30a4\u306e\u4f4d\u7f6e\u304b\u3089\u9ad8\u3055\u3092\u5f15\u304f\u3000\u5224\u5b9a\u5074\u3067\u5c71\u306e\u307b\u3046\u304c\u9ad8\u304b\u3063\u305f\u3089\u885d\u7a81\u3057\u3066\u3044\u308b\u3068\u307f\u306a\u3059\n}\n\n\n\n// \u30ce\u30fc\u30de\u30eb\u306e\u8a08\u7b97\nvec3 calcNormal(in vec3 pos){\n    vec3 nor;\n    vec2 e = vec2(0.01,0.0);\n    nor.x = map(pos + e.xyy) - map(pos - e.xyy);    //\u5c11\u3057\u3060\u3051\u305a\u3089\u3057\u305f\u3068\u304d\u306b\u3042\u305f\u308b\u5834\u6240\u3092\u3082\u3068\u3081\u3066\u3000\u5dee\u5206\u304b\u3089\u30ce\u30fc\u30de\u30eb\u3092\u4f5c\u6210\n    nor.y = map(pos + e.yxy) - map(pos - e.yxy);\n    nor.z = map(pos + e.yyx) - map(pos - e.yyx);\n    return normalize(nor);\n}\n\nfloat calcShadow(in vec3 ro, in vec3 rd){ // ro:\u30ab\u30e1\u30e9\u306e\u5ea7\u6a19 rd:\u30e9\u30a4\u30c8\u30d9\u30af\u30c8\u30eb\n    //\u30e9\u30a4\u30c8\u65b9\u5411\u306b\u30ec\u30a4\u3092\u98db\u3070\u3057\u3066\u3001\u885d\u7a81\u3057\u305f\u3089\u5f71\u306b\u3059\u308b\n    float res = 1.0;\n    float t = 0.1;\n    for (int i = 0; i <64; i++){\n        vec3 pos = ro + t*rd;\n        float h = map(pos);\n       res = min( res, max(h,0.0)*164.0/t );\n        if(res< 0.0001) break;\n        t+=h*0.5;\n    }\n    return res;\n}\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    vec2 p = fragCoord.xy / iResolution.xy; //\u89e3\u50cf\u5ea6\u306e\u6bd4\n    vec2 q = -1.0 + 2.0*p;                  // \u89e3\u50cf\u5ea6\u306e\u6bd4\u3092-1~1\u306b\u307e\u3068\u3081\u305f\n    q.x *= 1.777;                           // x\u65b9\u5411\u3092\u5927\u304d\u304f\u3000\u306a\u305c1.777?\n \n    vec3 ro = vec3(0.0, 1.65, -iTime);      // \u30ab\u30e1\u30e9\u306e\u30dd\u30b8\u30b7\u30e7\u30f3\n    vec3 rd = normalize( vec3(q, -1.0));    // \u30ec\u30a4\u306e\u65b9\u5411\n    \n    vec3 col = vec3(0.7, 0.8, 1.0);         // \u521d\u671f\u30ab\u30e9\u30fc\n    col *= 1.0 -0.5 *rd.y;                  // \u4e0a\u307b\u3069\u8272\u3092\u843d\u3068\u3057\u3066\u3044\u308b\n    float tmax =40.0;                       // \u63a2\u7d22\u6700\u5927\u8ddd\u96e2\u3000\uff14\uff10\u4ee5\u4e0a\u5965\u306b\u306a\u306b\u304b\u3042\u3063\u3066\u3082\u6253\u3061\u5207\u3089\u308c\u308b\n    float t = 0.0;                          // \u30ec\u30a4\u3092\u4f38\u3070\u3057\u3066\u3044\u304f\u4fc2\u6570\n    \n    for(int i=0; i<256; i++){               // 256\u56de\u30ec\u30a4\u3092\u9032\u3081\u3066\u3044\u304f \n        vec3 pos = ro + rd*t;               // \u30ab\u30e1\u30e9\u4f4d\u7f6e\u304b\u3089\u30ec\u30a4\u65b9\u5411\u306b\uff54\u5206\u3060\u3051\u79fb\u52d5\u3059\u308b\n        float h = map(pos);                 // \u30ec\u30a4\u65b9\u5411\u306b\u3042\u308b\u4e00\u756a\u8fd1\u3044\u5c71\u306e\u9762\u307e\u3067\u306e\u8ddd\u96e2\u3092\u53d6\u5f97\n        if(h < 0.001 || t > tmax) break;    // 0.001\u4ee5\u4e0b\u3060\u3063\u305f\u3089\u305d\u3053\u306b\u5c71\u306e\u9762\u304c\u3042\u308b\u3000tmax\u4ee5\u4e0a\u3060\u3063\u305f\u3089\u306a\u306b\u3082\u306a\u3044\n        \n        t += h*0.5;                         // \u5c71\u306e\u9762\u307e\u3067\u306e\u534a\u5206\u306e\u8ddd\u96e2\u5206\u3060\u3051\u30ec\u30a4\u3092\u3059\u3059\u3081\u308b\n    }\n    \n    vec3 light = normalize(vec3(1.0,0.1,-0.5)); // \u30e9\u30a4\u30c8\u30d9\u30af\u30c8\u30eb\n    \n    if(t < tmax){   // \u5c71\u306e\u9762\u306b\u885d\u7a81\u3057\u3066\u3044\u308b\n        vec3 pos = ro + t*rd;   // \u5c71\u306e\u9762\u306e\u5ea7\u6a19\n        vec3 nor = calcNormal(pos); // \u6cd5\u7dda\u3092\u8a08\u7b97\n        float sha = calcShadow(pos + nor *0.1,light); // \u5f71\u3092\u8a08\u7b97\n\n        float dif = clamp (dot(nor,light), 0.0,1.0);  // lumbert\u62e1\u6563\u7167\u660e\u306b\u3088\u308b\u30e9\u30a4\u30c6\u30a3\u30f3\u30b0\n        vec3 lig = vec3(2.0, 1.5,1.0)*dif *sha;       // \u30e9\u30a4\u30c8\u8272*\u30e9\u30a4\u30c6\u30a3\u30f3\u30b0*\u5f71\n        lig += vec3(0.1,0.2,0.3)*nor.y *2.0;          // \u4e0a\u65b9\u5411\u307b\u3069\u8272\u3092\u660e\u308b\u3081\u306b\n        \n        // \u6cd5\u7dda\u306b\u3088\u308b\u8272\u5909\u5316\u3000\u4e0a\u306b\u5411\u3044\u3066\u3044\u308b\u307b\u3069\u8272\u3092\u3064\u3051\u3066\u3044\u308b\n        vec3 mate = vec3(0.2, 0.3, 0.3)*0.5; \n        mate = mix(mate, vec3(0.2,0.15,0.1), smoothstep(0.7,0.9,nor.y));\n        col = lig * mate;\n        \n        float fog = exp(-0.002 *t * t); // fog\n        col *= fog;\n        col += ((1.0 - fog)*vec3(0.5,0.6,0.7));\n    }\n    \n    // gamut for monitor\n    col = sqrt(col);\n    \n    fragColor = vec4(col,1.0);\n}","name":"Image","description":"","type":"image"}]}