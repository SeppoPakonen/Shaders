{"ver":"0.1","info":{"id":"flfXzX","date":"1626147800","viewed":152,"name":"MovingQuadtree","username":"FoRenard","description":"Use Quadtree","likes":7,"published":1,"flags":0,"usePreview":0,"tags":[]},"renderpass":[{"inputs":[],"outputs":[{"id":"4dfGRr","channel":0}],"code":"const float PI = 3.141592;\n\nmat2 rotate2d(float _angle) {\n    return mat2(cos(_angle), -sin(_angle), sin(_angle), cos(_angle));\n}\n\nfloat rand(vec2 n) {\n    return fract(sin(dot(n, vec2(12.9898, 4.1414))) * 43758.5453);\n}\n\nstruct di {\n    vec2 p;\n    vec2 i;\n};\n\ndi devision(in vec2 p) {\n    float dec = 4.;\n    vec2 res = fract(p * dec);\n    vec2 ind = floor(p * dec) / dec;\n    float pl = abs(floor(sin(iTime))) * .3;\n    for(float i = 0.; i < 4.; i++) {\n        if(rand(ind + i) < .5) {\n            dec *= 2.;\n            res = fract(p * dec);\n            ind = floor(p * dec) / dec;\n        } else {\n            break;\n        }\n    }\n    return di(res, ind);\n}\n\nfloat circle(in vec2 p) {\n    p -= vec2(.5);\n    return floor(4. * dot(p, p));\n}\n\nfloat cros(in vec2 p) {\n    p -= vec2(.5);\n    float r = (abs(p.x) < .15) || (abs(p.y) < .15) ? 0. : 1.;\n    return r;\n}\n\nfloat rcros(in vec2 p) {\n    p -= vec2(.5);\n    p *= rotate2d(PI / 4.);\n    p += vec2(.5);\n    return cros(p);\n}\n\nfloat box(in vec2 p) {\n    p -= vec2(.5);\n    return (abs(p.x) < .3) && (abs(p.y) < .3) ? 0. : 1.;\n}\n\nfloat ibox(in vec2 p) {\n    return 1. - box(p);\n}\n\nvec2 movep(in vec2 p, in float r) {\n    float t = cos(mod(iTime, PI));\n    vec2 ep = p + (r < .5 ? vec2(t, 0.) : vec2(0., t));\n    return fract(ep);\n}\n\nvoid mainImage(out vec4 fragColor, in vec2 fragCoord) {\n    vec2 p = fragCoord / min(iResolution.x,iResolution.y);\n    di dis = devision(p);\n    p = dis.p;\n    vec2 ind = dis.i;\n\n    float d = 1., r;\n    r = rand(ind * .11);\n\n    p = movep(p, r);\n\n    if(r < .2) {\n        d = circle(p);\n    } else if(r < .4) {\n        d = cros(p);\n    } else if(r < .6) {\n        d = rcros(p);\n    } else if(r < .8) {\n        d = box(p);\n    } else {\n        d = ibox(p);\n    }\n\n    vec3 color = vec3(d);\n\n    fragColor = vec4(color, 1.0);\n}","name":"Image","description":"","type":"image"}]}