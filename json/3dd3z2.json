{"ver":"0.1","info":{"id":"3dd3z2","date":"1568890355","viewed":276,"name":"Quad Tree Pattern","username":"yuchengzhong","description":"Simple random pattern.procedural,random","likes":3,"published":3,"flags":0,"tags":[]},"renderpass":[{"inputs":[{"id":"XsX3zn","filepath":"/media/a/94284d43be78f00eb6b298e6d78656a1b34e2b91b34940d02f1ca8b22310e8a0.png","previewfilepath":"/media/ap/94284d43be78f00eb6b298e6d78656a1b34e2b91b34940d02f1ca8b22310e8a0.png","type":"cubemap","channel":0,"sampler":{"filter":"mipmap","wrap":"clamp","vflip":"false","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dfGRr","channel":0}],"code":"#define P_SUBDIV .2\n#define maxLayer 4\n#define random 12.0\n#define Num 8.0\n#define Chance 0.9\n\nvec3 hsv2rgb(vec3 c) \n{\n  vec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\n  vec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);\n  return c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);\n}\nvec4 sphere(vec2 uv)\n{\n  return vec4(-sign(length(uv-0.5)-0.5));\n}\nvec4 quad(vec2 uv)\n{\n  return vec4(uv.x>0.0&&uv.y>0.0&&uv.x<1.0&&uv.y<1.0?1.0:0.0);\n}\nfloat rnd(vec3 v) \n{\n    return fract(sin(dot(v,vec3(13.46,41.74,-73.36))+17.34)* 43758.5453); \n}\nfloat rnd(vec2 v)\n{\n    return fract(sin(dot(v.xy ,vec2(12.9898,78.233))) * 43758.5453);\n}    \n\nvec4 rndc(vec2 v)\n{\n  return vec4(hsv2rgb(vec3(rnd(v),0.9,1.0)),1.0);\n}\n\nvoid mainImage( out vec4 fragColor, vec2 uv )\n{\n    //uv = uv/iResolution.xy;//(0,1)\n    vec2 q = uv/iResolution.xy;\n    uv = uv/iResolution.x;//(0,1)\n    uv = uv*Num;\n    vec2 p = -1.0 + 2.0 * q;\n    float an1 = 0.0;\n\tfloat an2 = 0.9;\n    vec3 ro = 2.5*normalize(vec3(sin(an2)*cos(an1), cos(an2)-0.5, sin(an2)*sin(an1)));\n    vec3 ww = normalize(vec3(0.0,0.0,0.0) - ro);\n    vec3 uu = normalize(cross( vec3(0.0,1.0,0.0), ww ));\n    vec3 vv = normalize(cross(ww,uu));\n    vec3 rd = normalize( p.x*uu + p.y*vv + 1.4*ww );\n\n    vec4 colb = texture( iChannel0, rd );\n    vec4 colb2 = texture( iChannel0, rd*vec3(1.0,1.0,-1.0) );\n\n    \n    vec2 center;\n    float csize = 1.0;\n\n    float avgChance = 1.0/float(maxLayer+1);\n    float last = 2.0;\n    float signx = 0.0;\n    for(int i=0;i<maxLayer;i++)\n    {\n        center = floor(uv/csize)+0.5;\n        if(rnd(vec3(center,float(i)+random))<avgChance*Chance)\n        {\n          break;   \n        }\n        csize = csize/2.0;\n    }\n    float sizeMin = 1.0*pow(0.5,float(maxLayer));\n\n    float angle = 2.0*3.1415926*rnd(vec3(center,random*2.0))+iTime;   //(0,2pai)\n    float scale = mix(0.5,0.5,rnd(vec3(center,random*4.0)));       //(0.25,1.00)\n    scale = 1.0/scale;        //(1.0,4.0)\n    vec2 offset = -(1.0-scale)*0.5+(1.0-scale)*vec2(rnd(vec3(center,random*8.0)),rnd(vec3(center,random*16.0)));\n    offset *= 0.5;\n    float sintheta = sin(angle);\n    float costheta = cos(angle);\n    uv = uv/csize-center;          //(-0.5,0.5)\n    uv = vec2(uv.x*costheta-uv.y*sintheta  , uv.x*sintheta+uv.y*costheta)*1.4142135623730950488016887242097;\n    uv = (uv+offset)*scale;\n    uv = uv+0.5;\n\n    vec2 newUV = clamp(uv,0.0,1.0);\n    vec2 finalUV = sign(csize - 1.0/pow(2.0,float(maxLayer)))*vec2(newUV);\n    fragColor = mix(colb,rndc(center)*mix(colb2,vec4(1.0),0.75),quad(finalUV));//texture(iChannel0,finalUV);//vec4(finalUV ,0.0,0.0);\n    fragColor = pow(fragColor,vec4(1.0/2.2));\n}","name":"Image","description":"","type":"image"}]}