{"ver": "0.1", "info": {"id": "sltGRr", "date": "1635632410", "viewed": 70, "name": "Inercia demoparty 2021 SR", "username": "lechuga", "description": "Couldn't correct well the colors and the shape, always i need time ;_; but anyway, it was very fun, i've enjoy so much with people :) even if i wasn't psysically there xD\n\nwas awesome ! nice shaders from everyone, and waiting for the next time ^^", "likes": 3, "published": 1, "flags": 0, "usePreview": 0, "tags": [], "requires": ["imagebuf"]}, "renderpass": [{"inputs": [], "outputs": [{"id": "4dfGRr", "channel": 0}], "code": "\n#define rot(a) mat2(cos(a), sin(a), -sin(a), cos(a))\n#define pi acos(-1.)\nfloat t;\n\nfloat cc(float t){\n    return mix(floor(t), floor(t+1.), pow(smoothstep(0.,1., fract(t)), 40.));\n}\nfloat smin(float a, float b, float k){\n    float h = max(0., k-abs(a-b))/k;\n    return min(a,b)-h*h*k*.25;\n}\nfloat sbt(vec3 p, vec2 s){\n    return length(vec2(length(p.xy)-s.x, p.z))-s.y;\n}\nfloat sbb(vec3 p, vec3 s){\n    p=abs(p)-s;\n    return mix(max(max(p.x,p.y), p.z), length(p.xz), .26);\n}\nfloat fr1;\nfloat d2;\nfloat mainFractal( vec3 p){\n    \n    vec3 p1 = p;\n    //\n    //p.x = abs(p.x)-20.;\n    \n    //p1.yx = abs(p1.yx);\n    p1.yz*=rot(2.34);\n    float k, sc = 1.;\n    for(float i = 0.;i < 10.; i++){\n        p1.xz*=rot(p.y*.06251+i*i+cc(t*.31)+t*.25);\n        p1=abs(p1)-.2246-i*.215;\n        k = max(1., 1.877/dot(p1,p1));\n        p1 *= k;\n        sc *= k;\n    }\n    \n    p1.z = (fract(p1.z/20.-.5)-.5)*20.;\n    \n    float d = sbb(p1, vec3(1.)) / sc;\n    fr1 += .15/(.1+d*d);\n    d2 = d;\n    //d = max(d, -sbb(p, vec3(15.)));\n    return d*.26;\n}\n\nfloat h(float a){\n  return fract(sin(a*435.)*375.);\n}\nfloat g1,d1;\nfloat fr2;\nfloat center(vec3 p){\n  float d = mainFractal(p);\n  \n  float tt = t;\n  //tt += h(sin(p.x+t))*.001*.5;\n  p.xz*=rot(p.y*.34+tt*10.);\n  \n  float a = length(p)-3.-sin(p.x*.34+t)*sin(sin(p.z*.45+t));\n  a=mix(a, sbb(p, vec3(5.)), sin(cc(t))*.5+.5);\n  \n  d1 = a;\n  //g1+=1./(.1+a*a)*texture(texFFTSmoothed, 0.01).r*10.;\n  g1+=1./(.1+a*a);\n  d = smin(d, a, 1.);\n  return d;\n}\n\nfloat centerLight(vec3 p){\n  \n  float d = center(p);\n  \n  // p.y=abs(p.y);\n    //p.xz*=rot(p.y*.05);\n  \n  float a = length(p)-3.;\n  fr2 += 1./(1.+a*a*a);\n  d = smin(d,a,1.);\n  \n  \n  \n  return d;\n}\n\nfloat dr;\nfloat ff;\nfloat m(vec3 p){\n  float d = centerLight(p);\n  \n  vec3 p1 = p;\n  p.xz*=rot(p.y*.025);\n  p.x=abs(p.x)-50.;\n  p.yz*=rot(p.y*.0124+t*.1);\n  p.xz*=rot(p.y*.04+cc(t*.546)+t*sin(cc(-t*.25)+p.z*.00029895)*.75);\n  p.y += cc(t)+t;\n  p.x += sin(p.y*.34+t*40.);\n  for(int i = 0; i < 2; i++)\n  //p.xz = abs(p.xz)-15.-texture(texNoise, p.yz).r*.03153;\n  p.xz = abs(p.xz)-15.;\n  //float a = length(p.xz)-1.-texture(texFFTSmoothed, 0.01).r*20.;\n  float a = length(p.xz)-1.;\n  ff += .15/(3.5+a*a);\n  d = min(d, a);\n  p1.xz = abs(p.xz)-10.;\n  p1.yz*=rot(p1.z);\n  //float cucu = sbb(p1, vec3(1., 2., 9.));\n  dr = a;\n  //d=min(d, cucu);\n  return d;\n}\n\nvec3 nm(vec3 p){\n    const vec2 e = vec2(-.02424, 0.0345345);\n  \n  return normalize(m(p)-vec3(m(p-e.xyy), m(p-e.yxy),m(p-e.yyx)));\n}\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n\n    t = mod(iTime, 100.+(2.*pi))*.195;\n    vec2 uv = fragCoord/iResolution.xy;\n    uv -= 0.5;\n    uv /= vec2(iResolution.y / iResolution.x, 1);\n\n  vec3 s = vec3(0.01, 0.01,-15.-sin(t*.525)*20.-40.);\n  s.x += sin(t);\n  s.xy *= rot(cc(t));\n  vec3 p = s;\n  uv*=rot(sin(cc(t*2.)));\n  vec3 tg = vec3(0.6);\n  tg.yz*=rot(sin(cc(t)*.25));tg.xz*=rot(t);\n  vec3 cz = normalize(tg-s);\n  vec3 cx = normalize(cross(cz, vec3(0., -1., 0.)));\n  vec3 cy = normalize(cross(cz,cx));\n  vec3 r = mat3(cx,cy,cz)*normalize(vec3(-uv, 1.-length(uv)*.85+fract(length(uv)+cc(t*.25))));\n  vec2 dh = vec2(0.0);\n  vec3 co = vec3(0.)-length(uv)*.51;\n  for(int i = 0; i < 200; i++){\n      dh.y = m(p)*.65;\n    if(abs(dh.y) < .001) {\n      vec3 n = nm(p);\n      vec3 l = normalize(vec3(-1.)-p);\n      float dif = max(0., dot(l, n));\n      float fr = pow(max(0., 1.+dif), 3.);\n      float sp = pow(max(0., dot(reflect(-l, n), r)),30.);\n      co = vec3(dif+sp)*min(fr, .55);\n      if(abs(d2) < .5 || abs(dr) < .5) r=reflect(r, n), p+=2.;\n      else break;\n    }\n    if(dh.x > 200.) break;\n    dh.x += dh.y;\n    p+=dh.y*r;\n    co=g1*vec3(0.45,0.3, 0.64)*.124;\n    co +=fr1*vec3(1., .45, 0.)*.0041445;\n    co += fr2*vec3(0.45,0.3, 0.64)*.04131;\n    co += ff *vec3(0.9245)*.41;\n    //co = smoothstep(0., 1., co);\n    //co = pow(co,vec3(.83434));\n    //co *= max(0., length(p-s)/100.)*.21;\n  }\n\tfragColor = vec4(co, 1.);\n}", "name": "Image", "description": "", "type": "image"}]}